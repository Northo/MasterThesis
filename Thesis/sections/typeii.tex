\section{Type II Weyl semimetals}

The conic section problem with the intersecting plane restricted to pass through the node of the cone is trivially seen to have two solutions: a point and two intersecting lines.
Despite this, the possibility of a Weyl cone tilted beyond the Fermi level was never considered before \citeauthor{soluyanovTypeIIWeylSemimetals2015} described this new class of Weyl semimetals in 2015.
This now seemingly obvious possibility made an already rich field even more exciting, opening up for a wider range of novel and interesting effects.
\todo{add some concrete examples or cites}

In the case of massless fermions, the particle physics equivalent of the Weyl semimetal, such a tilt is not possible, due to the requirement of Lorentz invariance \todo{add cite or explain}.
In condensed matter physics, however, this is not an issue, and it is indeed a real class of materials \todo{cite examples}.
We denote these types of materials Type-II Weyl semimetals, as opposed to Type-I.
The transition between Type-I and Type-II is abrubt -- the Fermi surface goes form a single point to two intersecting lines, in other words going from a zero dimensional to a one dimensional surface.
\todo{Make sure this is indeed a one dimensional surface. It is kind of 1DxZ(2)}
\todo{Make sure it is one dim also for the 3D case, quadric surface, not conic intersection}
Type-II also has electron and particle pockets at the Fermi level.
While the density of states for a Type-I semimetal goes to zero as one approaches the Fermi level, this causes Type-II to have a finite density of states at the Fermi level.
\todo{End with something like: all in all this gives type ii weyl semimetal manifestly different properties from tyep i, useful both in practical applications and as an interesting phenomena seen from a purely scientific perspective}

\subsection{Hamiltonian}
We will firstly consider a slightly more realistic toy model for a Weyl semimetal, with a parameter taking the system from a Type-I to a Type-II.
This is instructive both in order to more intuitively see the origin of the terms causing the tilting of the Dirac cone, and also to see how two Dirac cones in the same Brillouin zone tilt in relation to each other.
We will then continue by linearizing the model around the Weyl points, regaining the familiar form of a Dirac cone, with an additional anisotropy term causing the tilt.

Using the general time-reversal breaking model described by \citeauthor{mccormickMinimalModelsTopological2017} we have
\begin{equation}
  \begin{split}
    H(\vec{k}) &= \left[ ( \cos k_x + \cos k_z - 2 )m + 2 t (\cos k_x - \cos k_0) \right] \sigma_1\\
    &\pe - 2 t \sin k_y \sigma_2 - 2t \sin k_z \sigma_3
    + \gamma (\cos k_x - \cos k_0).
  \end{split}
\end{equation}
The model has Weyl nodes at \(\vec{K}' = (\pm k_{0}, 0,0)\), and the parameter $\gamma$ controls the tilting of the emerging cones.
A value of $\gamma=0$ gives no tilt, while for $\gamma > |2 t|$ the Type-II system emerges.
Figure \ref{fig:ridgeline} shows the cross section \(k_{y} = 0\) of the eigenvalues of this system, as \(\gamma\) is gradually increased from 0 to 0.15 \todo{verify numbers}.
The \(\gamma\)-term ``warps'' the bands, and in the limit of Type-II the hole band crosses the Fermi level into positive energy, while the particle band crosses the Fermi level into negative energies.
We call these hole and electron pockets, respectively.

Linearizing around the Weyl nodes reduces to the familiar expression of a Dirac cone
\begin{equation}
  \label{eq:1}
  H(\vec{K} ^{'\pm} + \vec{k}) \approx \mp 2 t k_{x} \sin k_{0} \sigma_{1} - 2 t (k_{y} \sigma_{2} + k_{z} \sigma_{3}) \mp \gamma k_{x} \sin k_{0} \sigma_{0}, \quad k_{x}, k_{y}, k_{z} \ll 1.
\end{equation}
When the separation between the two nodes is \(\pi\), i.e. \(k_{0} = \pi/ 2 \), the linearized Hamiltonian of around the cone, is
\begin{equation}
  \label{eq:2}
  H'(\vec{k}) = \mp 2 t k_{x} \sigma_{x} - 2t k_{y} \sigma_{y} - 2 t k_{z} \sigma_{z} \mp \gamma k_{x}.
  % h'(\vec{v}) = -2t \vec{k} \vec{\sigma} - \gamma k_{x}.
\end{equation}
However, as the two noes are brought closer together, the effective Fermi velocity in the \(x\)-direction is rescaled, and the system is anisotropic even for no tilt (\(\gamma=0\)).
The expression may be made even more clear by moving the sign \(\pm\)-sign into the tilt parameter \(\gamma\).
The Hamiltonian is invariant under a sign change of the first term, as the isotropic Dirac Hamiltonian is invariant under inversion.
In the tilt-term, we move the sign dependence into \(\gamma \), and the linearized model is
\begin{equation}
  \label{eq:3}
  H'(\vec{k}) = - 2t \vec{k} \vec{\sigma} - \gamma^{\pm} k_{x},
\end{equation}
where \(\gamma ^{\pm} = \pm \gamma \) with the upper sign corresponding to the node at \(k_{x} = + k_{0}\) and the lower sign corresponds to the node at \(k_{x} = - k_{0}\).
As expected, we get two Dirac cones, tilting in opposite direction, but with the same amount.
\todo{How does this affect the Berry curvature and chern number?}
\todo{Maybe prettier/more correct to invert ky and kz, as that would also give the opposite chirality of the dirac points}

The linearized model are accurate in describing low energy interactions around the Fermi level.
For higher energies their validity falls apart, and more complex models are warranted.
In our calculations the linear models is sufficient, and much easier to work with, and we will thus mainly consider the linear model from here on.

\begin{itemize}
  \item gives rise to cones tilting opposite direction
  \item Linearized model valid for low energy interaction. For higher energy, the perfect cone model is not valid, as the cones does in fact touch.
  \item In this model, the hole pocket is ``shared'' between the two cones. There are also models with individual pockets (see \cite{mccormickMinimalModelsTopological2017})
\end{itemize}

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.4\textwidth]{figures/conicSection}
  \caption{\label{fig:conic-section-sketch} }
\end{figure}


\begin{figure}[ht]
  \centering
  \includegraphics[width=0.7\textwidth]{figures/typeIIridgeline}
  \caption{\label{fig:ridgeline} \todo{Write this} The values of the parameters were chosen to be \(m=0.15, t=-0.05, \) and \(2 k_{0}=\pi\).}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.7\textwidth]{figures/movetypeiinode}
  \caption{\label{fig:typeii:move-nodes} A Type-II Weyl semimetal with separation between the nodes \(2k_{0} = 0, \pi/2, \pi \).
    See main text for details about the model.}
\end{figure}


\subsection{Eigenstates and Landau levels}
The eigenvalues of Type-II Weyl semimetal simple to find, and are not qualitatively different from those of Type-I, other than the appearence of particle and hole pockets at the Fermi level.
We will also consider the Landau levels of these materials, which importantly are very different from Type-I.
In fact, erroneous treatment of the Landau spectrum of Type-II semimetals caused the original paper describing Type-II materials to mistakenly assert that the chiral anomaly would not be present for certain directions of a background magnetic field \cite{soluyanovTypeIIWeylSemimetals2015}\cite{sharmaChiralAnomalyLongitudinal2017}.

Eigenstates, spin, berry, etc

The issue with the Landau level description is that for certain directions of the \(B\)-field, the levels break down and become imaginary.
For Type-I materials, the description is valid for all dierections of the \(B\)-field, but as the cone tip into a Type-II material, the description breaks down when the \(B\)-field and tilt direction are perpendicular \cite{sharmaChiralAnomalyLongitudinal2017}, and as the magnitude of the tilt is increased, the Landau levels are only valid up to a certain angle between the tilt direction and magnetic field.

Consider the Hamiltonian
\begin{equation}
  \label{eq:4}
  H = \vec{\omega_{0}} \vec{k} + (\vec{v} \odot \vec{k}) \vec{\sigma},
\end{equation}
where \(\vec{\omega_{0}}\) is the tilt vector and \(\vec{v}\) is the Fermi velocity, which in general is anisotropic.
To find the Landau levels in a magnetic field \(\vec{B} = B_{z}\hat{z} \), we will ``Lorentz boost'' the system to a frame where the cone is not tilted, where we may use the usual approach for finding the Landau levels.
Firstly, assume that the tilt vector \(\vec{\omega_{0}}\) is in the \(x,z\)-plane, \(\vec{\omega_{0}} = (\omega_{\perp}, 0, \omega_{\parallel})\), which we can always achieve by a rotation around \(z\).
\todo{Proof by figure}
Introduce the \(\vec{B}\)-field by the minimal coupling \(\vec{k} \to \vec{q} = \vec{k} + e \vec{A}\), and use the Landau gague \(\vec{A} = -B_{z}y \hat{x}\).
The Hamitonian can thus be written
\begin{equation}
  \label{eq:5}
  H_{B} = \omega _{\perp} \left(k_{x} - e B_{z} y \right) + \omega _{\parallel} k_{z} + v_{y} k_{y} \sigma _{y} + v_{z} k_{z} \sigma _{z} + v_{x} \left(k_{x} - e B_{z} y\right) \sigma _{x},
\end{equation}
and the Landau level equation is
\begin{equation}
  \label{eq:6}
  \left(H_{B} - E\right) \ket{\psi } = 0.
\end{equation}
In order to use the ladder operator method used for the untilted cone, we must get rid of the \(q_{x}\) on the diagonal of the Hamiltonian.
\footnote{It would also be possible to choose the frame such that the tilt was both in \(x\) and \(y\) direction, in which case we would get ladder operators also on the diagonal.
  This system, albeight tedious, could also have been solved directly.
  \todo{Verify this}
}
To achieve this, we will use a ``Lorentz transformation'', which as we will show only leave \(k_{z}\) and \(E\) in the diagonal.
Act with the hyperbolic rotation operator \(\exp[\Theta /2 \sigma_{x}]\) on Eq. \eqref{eq:6}, and insert identity on the form \(\exp[\Theta /2 \sigma_{x}]\exp[-\Theta /2 \sigma_{x}]\) before the state vector.
By introducing the state in the rotate frame \(\ket{\tilde{\psi}} = \exp[- \Theta /2 \sigma_{x}] \mathcal{N} \ket{\psi } \), with \(\mathcal{N}\) a normalization factor compensating for the non-unitarity of the transformation, we get the eigenvalue equation
\begin{equation}
  \label{eq:7}
  (\exp[\Theta /2 \sigma_{x}] H_{B}\exp[\Theta /2 \sigma_{x}] - E \exp[\Theta \sigma_{x}]) \ket{\tilde{\psi}} = 0.
\end{equation}

We rewrite the Hamiltonian (Eq. \eqref{eq:5}) in a more compact and explicit way
\begin{equation}
  \label{eq:8}
  H_{B} = \left(\omega _{\perp} q_{x} + \omega _{\parallel}\right) \mathcal{I}_2 + \sum_i v_{i} q_{i} \sigma _{i},
\end{equation}
where \(\mathcal{I}_{2}\) is the identity matrix of size 2.
We now make the fortunate observation that, with the hyperbolic rotation operator denoted \( R = \exp [\Theta / 2 \sigma_{x}]\), the diagonal elements of
\[
R \sigma_{i} R
\]
are zero for $i=y$ and non-zero for \(i=x,z\).
We may thus rotate the \(x\) and \(z\) in and out of the diagonal elements, without accidentaly rotating the \(y\) components into the diagonal.

The problematic part of the Hamiltonian with regards to finding the Landau levels, are the terms containing \(q_{x}\) on the diagonal, i.e.
\[
  \omega _{\perp} q_{x} \mathcal{I}_{2} + v_{x} q_{x} \sigma _{x}.
\]
We will now find the boost parameter that eliminates \(q_{x}\) from the diagonal.
We have
\begin{equation}
  \label{eq:9}
  R^{2} = e^{\Theta \sigma _{x} } =
  \begin{pmatrix}
    \cosh \theta & \sinh \theta \\
    \sinh \theta & \cosh \theta
  \end{pmatrix}
\end{equation}
and as $[R, \sigma_{x}] = 0$,
\begin{equation}
  \label{eq:10}
  R \sigma _{x} R =  R^{2} \sigma _{x} =
  \begin{pmatrix}
    \sinh \theta & \cosh \theta \\
    \cosh \theta & \sinh \theta
  \end{pmatrix},
\end{equation}
as the effect of \(\sigma _{x}\) is to transpose the rows.
The requirement for \(q_{x}\) to be rotated out of the diagonal is thus
\begin{equation}
  \label{eq:11}
  \omega _{\perp} \cosh \theta + v_{x} \sinh \theta = 0.
\end{equation}
Solving for \(\theta \) we get
\begin{equation}
  \label{eq:12}
  \theta = \log (
  \pm \frac{\sqrt{v_{x} - \omega _{\perp}}}{\sqrt{v_{x} + \omega _{\perp}}}
  ).
\end{equation}
\todo{NB: depending of choice of sign in log, we get different signs in answer}
Alternatively, written in a slightly suggestive form,
\begin{equation}
  \label{eq:13}
  \tanh \theta =
  - \frac{\omega _{\perp}}{v_{x}}.
\end{equation}
\todo{For pedagogic reasons, include arctanh, which is only valid for -1 < x < 1, explicitly showing the collapse?}

Before we proceed any further, we will put the above into a more solid context, defining some useful quantities and more carefully investigte what is going on, which will be of help later when considering for the regions of validity, and the physical reason behind it.

\todo{nice plot of the landau levels acutally being squeezed}

Introduce the dimensionless \emph{tilt parameter}
\[
  \vec{t} =
  \left(
  \frac{\omega_{0x}}{v_{x}},
  \frac{\omega_{0y}}{v_{y}},
  \frac{\omega_{0z}}{v_{z}}
\right).
\]
Let also \(v_{i} = v_{0} a_{i}\), where \(\vec{a}\) is a vector describing the anisotropy of the system.
In these parameters, the eigenvalues of the system are
\begin{equation}
  \label{eq:14}
  E(\vec{k}) = \vec{\omega_{0}} \vec{k} \pm \sqrt{(v_{i} k_{i})^{2}} = \sqrt{(t_{i} v_{i} k_{i})^{2}} \pm \sqrt{(v_{i} k_{i})^{2}}.
\end{equation}
The system is Type-II if the first term dominates for any \(\vec{k}\), and Type-I if the last term dominates \cite{soluyanovTypeIIWeylSemimetals2015}.
The \(\vec{t}\)-vector is thus a convenient tool for categorization -- if \(t > 1\) we have a Type-II, else we have a Type-I.
\begin{proof}
  We may always rotate our coordinate system such that, without loss of generality, \(\vec{t} = t \hat{x}\).
  In that case, the first term obviously dominates in the \(x\)-direction, when $t>1$.
\end{proof}


Expressed in the parameter \(t\), the result in Eq. \eqref{eq:13} has an intuitive, and quite visual, interpretation.
As described above, we have rotated our frame such that the tilt is confined to the \(x,z\)-plane, i.e. no tilt in the \(y\)-direction.
The required hyperbolic tilt angle to eliminate the \(q_{x}\) in the diagonal elements of the Hamiltonian, originating from the tilt, was
\begin{equation}
  \label{eq:15}
  \theta = - \tanh^{-1} \frac{\omega_{\perp}}{v_{x}} = - \tanh^{-1} t_{x}.
\end{equation}
The inverse of \(\tan \), of course, diverges as the argument approaches \(\pm 1\), as shown in Figure \ref{fig:arctanh}.
\begin{figure}[ht]
  \centering
  % \includegraphics[options]{figures/path.pdf}
  \begin{tikzpicture}
    \pgfkeys{/pgf/declare function={arctanh(\x) = 0.5*(ln((1+\x)/(1-\x)));}}
    \begin{axis}[
      xmin=-1.2, xmax=1.2,
      ymin=-3.9, ymax=3.9,
      samples=200,
      enlarge x limits=false,
      grid=both,
      no markers,
      % axis equal
      xlabel=\(x\),
      ylabel=\(\tanh^{-1} x\),
      % ytick=none,
      ]
      \addplot +[thick,domain=-0.999:0.999] {arctanh(x)};
      \draw [thick,dashed,domain=-0.99:0.99] (1,-4) -- (1,4);
      \draw [thick,dashed,domain=-0.99:0.99] (-1,-4) -- (-1,4);
    \end{axis}
  \end{tikzpicture}
  \caption{\label{fig:arctanh} Plot of \(\tanh^{-1}\), which diverges as the argument goes to \(\pm 1\).}
\end{figure}
For \(t_{x} < 1\) we are able to find an angle \(\theta \) which transforms our Hamiltonian into a form which we may solve.
For \(t_{x} \geq 1\), however, no (real) solution of \(\theta \) exits, and the Landau level description collapses.
\todo{ Is this argumentation sufficient? What if we just have to use a different approach to find the LLs? }
It is also interesting that there are no restrictions on the tilt in \(z, t_{z}\).
Visually, this can be visualized by plotting the \(t\)-vector inside a unit sphere.
If the vector is outside the unit sphere, it is a Type-II, if it is inside, it is a Type-I.
Also, if the projection of the vector onto the \(x,y\)-plane is on the unit disk, the Landau level description is valid, if not, the Landau levels collapse.
All Type-I materials may thus be described by Landau levels, while it for Type-II is only valid for certain directions of the \(t\)-vector.
As the \(t\)-vector gets larger, the region of valid directions is reduced to an ever smaller cone around \(z\).
\begin{figure}[ht]
  \centering
  \includegraphics[width=0.75\textwidth]{figures/tiltSpherewBackground.png}
  \caption{\label{fig:tiltSphere} TODO}
\end{figure}

We now return to solving Eq. \eqref{eq:7}, using the solution angle we just found.
By insertion, and after some clean up, we get
\emph{note to thorvald: we chose \(\theta = Log \left(+ \dots\right) \)}
\begin{equation}
  \label{eq:16}
  =
  \begin{pmatrix}
    k_z (v_{z} + \omega_{\parallel} \gamma) - E \gamma   & -i k_{y} v_{y} + \gamma q_{x} (v_{x} - \frac{\omega_{\perp}^{2}}{v_{x}}) + E \omega_{\perp} \gamma /v_{x} - k_{z} \omega _{\perp} \omega _{\parallel} \gamma /v_{x}\\
    i k_{y} v_{y} + \gamma q_{x} (v_{x} - \frac{\omega_{\perp}^{2}}{v_{x}}) + E \omega_{\perp} \gamma /v_{x} - k_{z} \omega _{\perp} \omega _{\parallel} \gamma  / v_{x}
    & -k_{z} (v_{z} - \omega_{\parallel} \gamma) - E \gamma
  \end{pmatrix}.
\end{equation}
after some more clean up
\begin{equation}
  \label{eq:17}
  =
  \begin{pmatrix}
    k_z (v_{z} + \omega_{\parallel} \gamma) - E \gamma   & -i k_{y} v_{y} + v_{x} q_{x} / \gamma  - E  \gamma \beta  + k_{z} \omega _{\parallel} \gamma \beta \\
    i k_{y} v_{y} + v_{x} q_{x} / \gamma  - E  \gamma \beta  + k_{z} \omega _{\parallel} \gamma \beta
    & -k_{z} (v_{z} - \omega_{\parallel} \gamma) - E \gamma
  \end{pmatrix}.
\end{equation}
In order to simplify this further, absorb \(\gamma \beta \frac{k_{z} \omega_{\parallel} - E}{v_{x}}\) into \(q_{x}\).
Also, we will rescale all momenta to make the effective Fermi velocity isotropic.
Thus, let
\begin{equation}
  \begin{split}
    \tilde{q}_{x} &= \frac{v_{x}}{v_{F}} \left[  q_{x} / \gamma + \gamma \beta \frac{k_{z} \omega_{\parallel} - E}{v_{x}} \right],\\
    \tilde{q}_{y} &= \frac{v_{y}}{v_{F}} q_{y},\\
    \tilde{q}_{z} &= \frac{v_{z}}{v_{F}} q_{z}.\\
  \end{split}
\end{equation}
The eigenvalue equation is simply
\begin{equation}
  \label{eq:18}
  \left[  \gamma (\omega_{\parallel} k_{z} - E) \mathcal{I}_{2} +
  v_{F} \tilde{q}_{i} \sigma _{i} \right] \ket{\tilde{\psi}}= 0.
\end{equation}
If we now again introduce the magnetic field using minimal coupling, \(q_{x} \to  q_{x} - ey B_{z} \), this corresponds to an effective field \(B_{z} \frac{v_{x} v_{y}}{v_{F}^2} / \gamma \) in the new quantities.
This is because \(\tilde{q}_{x} \to  \tilde{q}_{x} - e y \frac{v_{x}}{v_{F}}  B_{z} /\gamma \), and including the rescaled \(\tilde{y} = \frac{v_{F}}{v_{y}} y\).

The Landau level equation thus reads
\begin{equation}
  \label{eq:19}
  \left[
  \sum\limits_{i} v_{F} \left(\tilde{q}_{i} + e A_{i} \right) \sigma _{i}
\right  ] \ket{\tilde{\psi}} =
(E-\omega_{\parallel} k_{z}) \gamma \ket{\tilde{\psi}},
\end{equation}
where \(\vec{A}=-B_{z} \frac{v_{x} v_{y} }{v_{F}^2} / \gamma  \tilde{y} \hat{x}\).
We may thus use directly the result for the untilted cone, \todo{eq ref}, giving
\begin{align}
  \label{eq:20}
  \left(E-\omega _{\parallel} k_{z} \right) \gamma &= \sign (m) v_{F} \sqrt{2 |m| e \frac{B v_{x} v_{y}}{ v_{F} ^2 \gamma } \hbar + \tilde{q}_{z}^2 \hbar ^2}, & m \neq 0,\\
  \left(E-\omega _{\parallel} k_{z} \right) \gamma &= - s \hbar  \tilde{q}_{z} v_{F}, & m=0.
\end{align}
Cleaning up, we get
\begin{align}
  \label{eq:21}
  E &= \omega _{\parallel} k_{z} + \sign(m) \sqrt{2 |m| e \frac{v_{y} v_{x} B}{\gamma ^3} \hbar + v_{z}^2 k_{z}^2\hbar ^2 /\gamma ^2}, & m\neq 0,\\
  E &= k_{z} \left( \omega _{\parallel} - s \hbar v_{z} / \gamma  \right), & m=0.
\end{align}

As the tilt is increased, \(\gamma = 1 / \sqrt{1-\beta ^{2}}\) diverges to infinity.
With the trivial substitution \(\alpha = \frac{1}{\gamma }\), which goes to zero, this gets an intuitive interpretation.
\begin{equation}
  \label{eq:22}
  E = \omega _{\parallel} k_{z} + \sign(m)  \sqrt{2 |m| e B v_{x} v_{y} \alpha  ^3 \hbar + v_{z} ^2 k_{z}^2\hbar ^2 \alpha ^2}
\end{equation}
As the tilt increases, the Landau levels converge towards \(\omega _{\parallel} k_{z}\).
In particular, the separation between Landau levels \(m\) \todo{maybe use the word cyclotron frequency} is reduced by a factor \(\alpha ^{\frac{3}{2}}\).
The effect of the tilt on the Landau levels is to squeeze the Landau levels together, and we will call the \(\alpha ^{\frac{3}{2}}\) the \emph{squeezing factor}.
We note that when approaching the degree of tilt where we are no longer able to find a boost which enables us to solve for the Landau levels, i.e. when \(\beta \to 1\), the squeezing factor goes to zero.
As the tilt exceeds this limit, the squeezing factor is imaginary.

The eigenstate of
\[
H = v_{F} \sigma ^{i} ( p_{i} + e A_{i} ),
\]
with \(A_{i} = - B_{z} y \delta _{i x}\), given in the position basis is
\begin{equation}
  \phi _{\vec{k} m s}(\vec{r}) = \frac{1}{\sqrt{L_xL_z}}
  \frac{e^{ik_x x}e^{ik_z z}}{\sqrt{\alpha _{k_z m s}^2 + 1}}
  e^{-\frac{y-k_x l^2}{2 l_B^2}}
  \begin{pmatrix}
    \frac{\alpha _{k_z m s}}{\sqrt{2^{M-1} (M-1)! \sqrt{\pi } l_B}} H_{M-1}\left( \frac{y-k_x l_B^2}{l_B} \right)\\
    \frac{1}{\sqrt{2^M M! \sqrt{\pi } l_B}} H_M \left( \frac{y-k_x l_B^2}{l_B} \right)
  \end{pmatrix},
\end{equation}
where capital letters indicate absolute value of corresponding quantity, $M=|m|, \vec{k} = (k_x, k_z)$, and with the normalization factor
\begin{equation}
  \alpha _{k_z m s} = \frac{-\sqrt{2eB\hbar M}}{\frac{E_{k_z m s}}{s v_{F}} - \hbar  k_z}.
\end{equation}
Taking care to keep track of boosted and rescaled quantites, the eigenstate in the boosted frame is
\begin{equation}
  \label{eq:29}
  \tilde{\psi}(\vec{r}) =
  \frac{1}{\sqrt{L_xL_z}}
  \frac{e^{ik_x x}e^{i k_z z}}{\sqrt{\alpha _{\tilde{k}_z m s}^2 + 1}}
  e^{-\frac{\left(\tilde{y} - \tilde{q}_x l_{B'}^2\right)^2}{2 l_{B'}^2}}
  \begin{pmatrix}
    \frac{\alpha _{\tilde{q}_z m s}}{\sqrt{2^{M-1} (M-1)! \sqrt{\pi } l_{B'}}} H_{M-1}\left( \frac{\tilde{y} - \tilde{q}_x l_{B'}^2}{l_{B'}} \right)\\
    \frac{1}{\sqrt{2^M M! \sqrt{\pi } l_{B'}}} H_M \left( \frac{\tilde{y} - \tilde{q}_x l_{B'}^2}{l_{B'}} \right)
  \end{pmatrix},
\end{equation}
with
\begin{equation}
  \alpha _{\tilde{q}_z m s} = \frac{-\sqrt{2e B' \hbar M}}{ \gamma \frac{E_{\tilde{q}_z m s} - \omega _{\parallel} k_{z}}{s v_{F}} - \hbar  \tilde{q}_z},
\end{equation}
where \(E\) is the solution in the unboosted frame and
\[
B' = B \frac{v_{x} v_{y}}{v_{F}^2} \alpha
\]
\todo{Check if Ly should be changed}


and thus the original eigenstate \(\ket{\psi } = 1 /\mathcal{N} e^{\theta /2 \sigma _{x}} \ket{\tilde{\psi} }\) of the tilted system is easily found.

Repeating the calculation of the response function is now straightforward, but rather tedious.
Due to the boost transformation, the elements of the spinor in the untilted system, Eq. \eqref{eq:29}, mix.
We thus have twice as many terms to keep track of.
Take for example the matrix element of the current operator
\[
  J_{\vec{k} m s; \vec{k}+\qvec{q} n s } (\vec{q}) = \int \mathrm{d}y e^{-i q_{y} y}
  s v_{F} e \phi ^{*}_{\vec{k} m s} (y) \sigma ^{x} \phi _{\vec{k} + \qvec{q} n s}(y).
\]
We must find the matrix product \(\phi \sigma_{x} \phi \).
Recall that \(\phi \frac{1}{\mathcal{N}} e^{\theta /2 \sigma _{x}} \tilde{\phi} \), and thus we must find
\[
  \phi ^{*} \sigma _{x} \phi = \frac{1}{\mathcal{N}^{*} \mathcal{N}} \tilde{\phi}^{*} e^{\theta /2 \sigma _{x}} \sigma _{x} e^{\theta /2 \sigma _{x}} \tilde{\phi} =  \frac{1}{\mathcal{N}^{*} \mathcal{N}} \tilde{\phi}^{*} \sigma _{x} e^{\theta \sigma _{x}} \tilde{\phi}.
\]
With the previously found solution \(\theta = - \tanh ^{-1} t_{x}\), we get the rather simple form
\[
  e^{\theta \sigma _{x}} =
  \begin{pmatrix}
    1 & -t_{x}\\
    -t_{x} & 1
  \end{pmatrix}
  \frac{1}{\sqrt{1-t_{x}^2}}.
\]
With
\[
  \tilde{\phi} = e^{-\frac{(y - k_{x} l_{B}^2)^2}{2 l_{B}^2}}
  \begin{pmatrix}
    a_{\vec{k} m s} H_{M-1} (\frac{y-k_{x} l_{B}^2}{l_{B}})\\
    b_{\vec{k} m s} H_{M} (\frac{y-k_{x} l_{B}^2}{l_{B}})
  \end{pmatrix}
\]
we see how the expressions change when \(t_{x}\) become non-zero.
Where we previoulsy had
\begin{equation}
  \label{eq:27}
  \phi ^{*}_{\vec{k} m s} \sigma _{x} \phi _{\vec{k} + \qvec{q} n s}
  =
  a_{\vec{k} m s} H_{M-1}(\dots) \left[ b_{\vec{k}+\qvec{q} n s} H_{N}(\dots) \right]
  + \dots
\end{equation}
the contents of the square brackets must now include also the other element of the spinor:
\begin{equation}
  \label{eq:28}
  \phi ^{*}_{\vec{k} m s} \sigma _{x} e^{\theta \sigma _{x}} \phi _{\vec{k} + \qvec{q} n s}
  =
  a_{\vec{k} m s} H_{M-1}(\dots)
  \left[
    b_{\vec{k}+\qvec{q} n s} H_{N}(\dots)
    - t_{x} a_{\vec{k} + \qvec{q} n s} H_{N-1} (\dots)
  \right]
  \frac{1}{\sqrt{1-t_{x}^2}}
  + \dots .
\end{equation}
Doing this, Eq. (4.59) \todo{fix ref} in the project thesis, becomes
\begin{equation}
  \label{eq:28}
  \begin{split}
    J_{\vec{k}ms; \vec{k}+\qvec{q} ns}(\vec{q}) &=
    s v_F e \int \mathrm{d}\tilde{y} \: l_B
\exp \left[- \frac{1}{4} l_B^2 \left\{
    \qvec{q}_y^2 + 2 i (2k_x + q_x) q_y
    \right\}\right]\\
  e^{-\tilde{y}^2}
   &\left[
    a_{\vec{k}ms}b_{\vec{k} + \qvec{q} ns}
    H_{M-1} \left( \tilde{y} + \frac{l_B}{2}(q_x - iq_y) \right)
    H_N\left( \tilde{y} + \frac{l_B}{2}(-q_x - iq_y) \right) \right.\\
    &+ a_{\vec{k}ms}a_{\vec{k} + \qvec{q} ns}
    H_{M-1} \left( \tilde{y} + \frac{l_B}{2}(q_x - iq_y) \right)
    H_{N-1}\left( \tilde{y} + \frac{l_B}{2}(-q_x - iq_y) \right)\\
   & +
    b_{\vec{k}ms} a_{\vec{k} + \qvec{q} ns}
    H_M \left( \tilde{y} + \frac{l_B}{2}(q_x - iq_y) \right)
    H_{N-1} \left( \tilde{y} +  \frac{l_B}{2}(-q_x - iq_y)\right)\\
    &\left. +
    b_{\vec{k}ms} b_{\vec{k} + \qvec{q} ns}
    H_M \left( \tilde{y} + \frac{l_B}{2}(q_x - iq_y) \right)
    H_{N} \left( \tilde{y} +  \frac{l_B}{2}(-q_x - iq_y)\right)
    \right].
  \end{split}
\end{equation}
\begin{align}
  a_{\vec{k} m s} a_{\vec{k} + \qvec{q} n s} &=
  \frac{\alpha _{\vec{k} m s} \alpha _{\vec{k} + \qvec{q} n s}}{\sqrt{\alpha _{\vec{k} m s}^2 + 1} \sqrt{\alpha _{\vec{k} + \qvec{q} n s}^2 + 1}}
  \left[ 2^{M+N-2} (M-1)! (N-1)! \pi l_{B}^2 \right]^{-\frac{1}{2}}\\
  b_{\vec{k} m s} b_{\vec{k} + \qvec{q} n s} &=
  \frac{1}{\sqrt{\alpha _{\vec{k} m s}^2 + 1} \sqrt{\alpha _{\vec{k} + \qvec{q} n s}^2 + 1}}
  \left[ 2^{M+N} M! N! \pi l_{B}^2 \right]^{-\frac{1}{2}}
\end{align}
Let us in addition to Eqs. (4.66)-(4.73) in project report define
\begin{multline}
  \label{eq:30}
  \frac{\Xi _3(\vec{q}, m, n, s)}{
    \sqrt{\alpha _{\vec{k} \vphantom{\qvec{q}} ms}^2 +1}
    \sqrt{\alpha _{\vec{k}+\qvec{q} ns}^2 + 1}
  }
  =
  \int \mathrm{d}\tilde{y} \; l_B e^{-y^2}
  a_{\vec{k}ms}a_{\vec{k} + \qvec{q} ns}\\
  H_{M-1} \left( \tilde{y} + \frac{l_B}{2}(q_x - iq_y) \right)
  H_{N-1}\left( \tilde{y} + \frac{l_B}{2}(-q_x - iq_y) \right)
  ,
\end{multline}
and
\begin{multline}
  \label{eq:31}
  \frac{\Xi _4(\vec{q}, m, n, s)}{
    \sqrt{\alpha _{\vec{k} \vphantom{\qvec{q}} ms}^2 +1}
    \sqrt{\alpha _{\vec{k}+\qvec{q} ns}^2 + 1}
  }
  =
  \int \mathrm{d}\tilde{y} \; l_B e^{-y^2}
  b_{\vec{k}ms}b_{\vec{k} + \qvec{q} ns}\\
  H_{M} \left( \tilde{y} + \frac{l_B}{2}(q_x - iq_y) \right)
  H_{N}\left( \tilde{y} + \frac{l_B}{2}(-q_x - iq_y) \right)
  ,
\end{multline}
with
\begin{align}
  \Xi_3 ^{(1)}(\vec{q}, m, n, s) &= \alpha _{\vec{k} m s} \alpha _{\vec{k} + \qvec{q} n s} \sqrt{\frac{2^{N-1} (M-1)!}{2^{M-1} (N-1)!}}
                                   \left( \frac{-q_x - iq_y}{2} l_B \right)^{N-M}
                                   L^{N-M}_{M-1} \left( \frac{\qvec{q}_y^2 l_B^2}{2} \right),\\
                                   %%%
  \Xi_3 ^{(2)}(\vec{q}, m, n, s) &= \alpha _{\vec{k} m s} \alpha _{\vec{k} + \qvec{q} n s} \sqrt{\frac{2^{M-1} (N-1)!}{2^{N-1} (M-1)!}}
                                   \left( \frac{q_x - iq_y}{2} l_B \right)^{M-N}
                                   L^{M - N}_{N-1} \left( \frac{\qvec{q}_y^2 l_B^2}{2} \right),\\
  \Xi_3(\vec{q}, m, n, s) &=
          \begin{cases}
            \Xi _4 ^{(1)} & \text{if } N \geq M\\
            \Xi _4 ^{(2)} & \text{if } N \leq M
          \end{cases}, \label{eq:42}
\end{align}
\begin{align}
  \Xi_4 ^{(1)}(\vec{q}, m, n, s) &=  \sqrt{\frac{2^N M!}{2^M N!}}
                                   \left( \frac{-q_x - iq_y}{2} l_B \right)^{N-M}
                                   L^{N-M}_{M} \left( \frac{\qvec{q}_y^2 l_B^2}{2} \right),\\
                                   %%%
  \Xi_4 ^{(2)}(\vec{q}, m, n, s) &= \sqrt{\frac{2^{M} N!}{2^N M!}}
                                   \left( \frac{q_x - iq_y}{2} l_B \right)^{M-N}
                                   L^{M - N}_N \left( \frac{\qvec{q}_y^2 l_B^2}{2} \right),\\
  \Xi_4(\vec{q}, m, n, s) &=
          \begin{cases}
            \Xi _4 ^{(1)} & \text{if } N \geq M\\
            \Xi _4 ^{(2)} & \text{if } N \leq M
          \end{cases}, \label{eq:42}
\end{align}


\todo{squeezing figure}

Maybe use squeezing \(\alpha \) instead of \(\gamma \)?
\todo{Fix anisotropic directions}


\todo{Squeezing, etc}



We will boost the frame of the tilted cone such that the system is again isotropic, and use the well known solution for the Landau levels in that frame.
The issue is that the boost is only valid for certain directions of the field.
Add pretty figures describing the situation.

\section{Notes}
\subsection{Spin states for Dirac cone}
See mathematica file.

Consider a simple Dirac cone Hamiltonian \(H_{D} = s v_{F} \vec{\sigma} \vec{p}\), with \(s\) denoting the chirality of the cone.
The eigenvalues of the system is of course \(E = \pm v_{F} k, \quad k=|\vec{k}|\).
We want to find the eigenstates of this system.
Assume plane wave state, and some arbitrary linear combination of spin up and spin down,
\[
  \psi _{\pm} = e^{i \vec{k} \vec{r}} \alpha
  \begin{pmatrix}
    1\\
    b
  \end{pmatrix},
\]
where \(\alpha \) is some normalization.
Solving the time independent Schrodinger equation
\[
H \psi = E \psi,
\]
we may solve for \(b\), which gives
\begin{equation}
  \label{eq:23}
  b = -\frac{k_{z} \pm k}{k_{x} - i k_{y}}.
\end{equation}
Requiring normalization of the state \(\braket{\psi | \psi } = 1\) gives the normalization
\[
|\alpha |^2 = \frac{1}{1 + |b|^2}.
\]

Having found the states, we find the spin expectation value
\begin{equation}
  \label{eq:24}
  \vec{S} = \braket{\psi | \hat{S} | \psi },
\end{equation}
where \(\vec{S}\) is the spin expectation value and \(\hat{S} = \frac{\vec{\sigma}}{2} \) is the spin operator, where \(\hbar \) was set to 1.
Simply evaluating Eq. \eqref{eq:24}, yields
\begin{equation}
  \label{eq:25}
  \vec{S} = \pm \frac{\vec{k}}{2 k}.
\end{equation}

The spin structure is that of a hedgehog.

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.75\textwidth]{figures/spinStructureWeyl}
  \caption{\label{fig:spinStructure} }
\end{figure}



\subsection{4x4 tilted weyl cone}
In order to separate weyl cones in momentum, we introduce a pseuod spin degree of freedom, making the system 4x4.
We may then get solutions with the cones separated in momentum (or energy).
We may also ask what heppens if we try to separate tilted cones?

Firstly, in the most intuitive way to extend the 2x2 tilted cones to 4x4, we get that the cones tilt opposite direction, thus not superimposed even before separating in momentum.
They are after that simple to separate in momentum.
We might wonder if it makes sense to do it in this way.

The lattice model of the energy dispersion to explain tilted cones gives two cones separated in momentum, and tilting corresponds to ``bending'' the dispersion curves between them.
Maybe we therefore always have cones separated in momentum, and thus tilting superimposed does not make sense?
All depends on the origin of the tilt I believe.
Also, we must not confuse the global dispersion relation, to the Dirac cones which are expansions around the nodes.

Key to understand how spin behaves in all of this, and also maybe the symmetries.

To properly investigate the symmetry properties of the system, we must consider the 4x4, not 2x2 Hamiltonians.
While the 2x2 system does a goood job at describing a single cone, much important phsycis is lost when reducing the 4x4 Hamiltonian.
For example, the requirement that the total Berry curvature over the entire Briolluine zone is zero is not met for the 2x2 Hamiltonian, as it describes only one cone of a certain chirality.
The 4x4, however, includes two cones, which may in general be superimposed, thus conserving the total zero-divergence of the Berry curvature.
As a matter of fact, the inclusion of both cones is important also for symmetry considerations.

Let
\[
  H = v_{F} \tau _{x} \otimes \vec{\sigma} \vec{k},
\]
where \(\tau \) is some pseudo spin degree of freedom, transforming like \(\vec{r}\) under parity in time reversal.
This system describes two superimposed cones at the origin, with opposite chirality.
The effect of parity \(\mathcal{P}\) and time reversal \(\mathcal{T}\) is
\begin{table}[h]
  \centering
  \begin{tabular}{lcc}
    & \(\mathcal{P}\) & \(\mathcal{T}\)\\
    \hline
    \(\tau \) & - & +\\
    \(\sigma \) & + & -\\
    \(k\) & - & -
  \end{tabular}
\end{table}
\begin{equation}
  \label{eq:26}
  \begin{aligned}
    \mathcal{P} \tau \mathcal{P}^{\dagger} &= -\tau, & \mathcal{T} \tau \mathcal{T}^{\dagger} &= +\tau\\
    \mathcal{P} \sigma  \mathcal{P}^{\dagger} &= + \sigma,  & \mathcal{T} \sigma  \mathcal{T}^{\dagger} &= -\sigma \\
    \mathcal{P} k \mathcal{P}^{\dagger} &= -k, & \mathcal{T} k \mathcal{T}^{\dagger} &= -k
  \end{aligned}
\end{equation}
Obviously then, the Hamiltonian is both time reversal and parity invariant, as \(\mathcal{P} \mathcal{P}^{\dagger} = \mathcal{T} \mathcal{T}^{\dagger} = 1\).

A tilt term \(\tau _{x} \otimes \mathcal{I} \vec{\omega} _{0} \vec{k}\) breaks time reversal invariance, while maintaining parity invariance.
This is due to the two cones of opposite chirality tilting in opposite directions.

\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    \draw[->] (-4, 0) -- (4, 0) node[right] {\(k\)};
    \draw[->] (0, 0) -- (0, 4) node[right] {\(E\)};

    % vf = 1, v0 = 0.8
    \draw[blue] (-3.5, 0.7) -- (0, 0) -- (2, 3.6) node[right] {\(\ket{\uparrow}\)} coordinate[pos=0.7] (a);
    \draw[red] (3.5, 0.7) node[right] {\(\ket{\downarrow }\)} -- (0, 0) -- (-2, 3.6)
    coordinate[pos=0.7] (b);

    \draw[->] (a) -- ++(1, 0);
    \draw[->] (b) -- ++(1, 0);
  \end{tikzpicture}
  \caption{Time reversal breaking in tilted system.
    Cross section in the tilt direction shown, with blue showing one cone and red the other.
    Black arrows indicate spin direction, which for \(\ket{\uparrow {}}\) is proporitional to  \(k\) while for \(\ket{\downarrow {}}\) is proportional to \( -k \).
  }
\end{figure}
